\chapter{图像修复算法}

\begin{breakablealgorithm}
\caption{DPS Algorithm }
\label{DPS algorithm }
    \begin{algorithmic}[1]
   \REQUIRE Input $N$, $y$, $\{\zeta_i\}_{i=1}^{N}$, $\{\Tilde{\sigma}_i\}_{i=1}^{T}$
   \STATE $X_{T}\sim \mathcal{N}(0,\boldsymbol{I})$
   \FOR{$i$ = $N$ to 0}
   \STATE Set $\hat{s}\xleftarrow{} s_{\theta}(x_i,i)$
   \STATE Set $\hat{x_0} \xleftarrow{} \frac{1}{\sqrt{\Bar{\alpha}_i}}\left(x_i+(1-\Bar{\alpha}_i)\hat{s}\right)$
   \STATE Simulate $z\sim \mathcal{N}(0,\boldsymbol{I})$
   \STATE Set $x^{\prime}_{i-1}\xleftarrow{} \frac{\sqrt{\alpha_i}\left(1-\bar{\alpha}_{i-1}\right)}{1-\bar{\alpha}_i} \boldsymbol{x}_i+\frac{\sqrt{\bar{\alpha}_{i-1}} \beta_i}{1-\bar{\alpha}_i} \hat{\boldsymbol{x}}_0+\Tilde{\sigma}_i {z} $
   \STATE Update $x_{i-1}\xleftarrow{} {x}_{i-1}^{\prime}-\zeta_i \nabla_{{x}_t}\left\|{y}-\mathcal{A}\left(\hat{{x}}_0\right)\right\|_2^2 $
   \ENDFOR
   \RETURN $\hat{x}_0$ 
    \end{algorithmic}
\end{breakablealgorithm}
基于DPS算法，我们现在提出我们采用更高效率基于DDIM模型的算法。 
\begin{breakablealgorithm}
\caption{Image Restoration Algorithm }
\label{ours algorithm }
    \begin{algorithmic}[1]
   \REQUIRE Input $T$, $y$, $\{\eta_k\}_{k=1}^{T}$, $\{\sigma_k\}_{k=1}^{T}$
   \STATE $X_{T}\sim \mathcal{N}(0,\boldsymbol{I})$
   \FOR{$t=T$, $T-1$, $\cdots$, 0}
   \STATE Set $\hat{s}\xleftarrow{} s_{\theta}(t,x_t)$
   \STATE Set $\hat{x_0} \xleftarrow{} \frac{1}{\sqrt{\Bar{\alpha}_t}}\left(x_t+\Bar{\beta}_t\hat{s}\right)$
   \STATE Simulate $z\sim \mathcal{N}(0,\boldsymbol{I})$
   \STATE Set $x^{\prime}_{t-1}\xleftarrow{} \frac{\sqrt{\alpha_t}\left(1-\bar{\alpha}_{t-1}\right)}{1-\bar{\alpha}_t} \boldsymbol{x}_t+\frac{\sqrt{\bar{\alpha}_{t-1}} \beta_t}{1-\bar{\alpha}_t} \hat{\boldsymbol{x}}_0+\sigma_t {z} $
   \STATE Update $x_{t-1}\xleftarrow{} {x}_{t-1}^{\prime}-\eta_t \nabla_{{x}_t}\left\|{y}-\mathcal{A}\left(\hat{{x}}_0\right)\right\|_2 $
   \ENDFOR
   \RETURN $\hat{x}_0$ 
    \end{algorithmic}
\end{breakablealgorithm}
